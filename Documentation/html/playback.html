<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Playback</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Playback </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this example, we provide a complete program that demonstrates the use of <a class="el" href="class_rt_audio.html" title="Realtime audio i/o C++ classes.">RtAudio</a> for audio playback. Our program produces a two-channel sawtooth waveform for output.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_rt_audio_8h.html">RtAudio.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Two-channel sawtooth wave generator.</span></div>
<div class="line"><span class="keywordtype">int</span> saw( <span class="keywordtype">void</span> *outputBuffer, <span class="keywordtype">void</span> *inputBuffer, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nBufferFrames,</div>
<div class="line">         <span class="keywordtype">double</span> streamTime, <a class="code" href="_rt_audio_8h.html#a80e306d363583da3b0a1b65d9b57c806">RtAudioStreamStatus</a> status, <span class="keywordtype">void</span> *userData )</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, j;</div>
<div class="line">  <span class="keywordtype">double</span> *<a class="code" href="structbuffer.html">buffer</a> = (<span class="keywordtype">double</span> *) outputBuffer;</div>
<div class="line">  <span class="keywordtype">double</span> *lastValues = (<span class="keywordtype">double</span> *) userData;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> ( status )</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Stream underflow detected!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Write interleaved audio data.</span></div>
<div class="line">  <span class="keywordflow">for</span> ( i=0; i&lt;nBufferFrames; i++ ) {</div>
<div class="line">    <span class="keywordflow">for</span> ( j=0; j&lt;2; j++ ) {</div>
<div class="line">      *<a class="code" href="structbuffer.html">buffer</a>++ = lastValues[j];</div>
<div class="line"> </div>
<div class="line">      lastValues[j] += 0.005 * (j+1+(j*0.1));</div>
<div class="line">      <span class="keywordflow">if</span> ( lastValues[j] &gt;= 1.0 ) lastValues[j] -= 2.0;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="class_rt_audio.html">RtAudio</a> dac;</div>
<div class="line">  <span class="keywordflow">if</span> ( dac.getDeviceCount() &lt; 1 ) {</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;\nNo audio devices found!\n&quot;</span>;</div>
<div class="line">    exit( 0 );</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="struct_rt_audio_1_1_stream_parameters.html">RtAudio::StreamParameters</a> parameters;</div>
<div class="line">  parameters.deviceId = dac.getDefaultOutputDevice();</div>
<div class="line">  parameters.nChannels = 2;</div>
<div class="line">  parameters.firstChannel = 0;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sampleRate = 44100;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bufferFrames = 256; <span class="comment">// 256 sample frames</span></div>
<div class="line">  <span class="keywordtype">double</span> data[2];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    dac.openStream( &amp;parameters, <a class="code" href="utypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, RTAUDIO_FLOAT64,</div>
<div class="line">                    sampleRate, &amp;bufferFrames, &amp;saw, (<span class="keywordtype">void</span> *)&amp;data );</div>
<div class="line">    dac.startStream();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">catch</span> ( <a class="code" href="class_rt_audio_error.html">RtAudioError</a>&amp; <a class="code" href="group__gtc__constants.html#ga4b7956eb6e2fbedfc7cf2e46e85c5139">e</a> ) {</div>
<div class="line">    <a class="code" href="group__gtc__constants.html#ga4b7956eb6e2fbedfc7cf2e46e85c5139">e</a>.printMessage();</div>
<div class="line">    exit( 0 );</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="keywordtype">char</span> input;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;\nPlaying ... press &lt;enter&gt; to quit.\n&quot;</span>;</div>
<div class="line">  std::cin.get( input );</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    <span class="comment">// Stop the stream</span></div>
<div class="line">    dac.stopStream();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">catch</span> (<a class="code" href="class_rt_audio_error.html">RtAudioError</a>&amp; <a class="code" href="group__gtc__constants.html#ga4b7956eb6e2fbedfc7cf2e46e85c5139">e</a>) {</div>
<div class="line">    <a class="code" href="group__gtc__constants.html#ga4b7956eb6e2fbedfc7cf2e46e85c5139">e</a>.printMessage();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> ( dac.isStreamOpen() ) dac.closeStream();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>We open the stream in exactly the same way as the previous example (except with a data format change) and specify the address of our callback function <em>"saw()"</em>. The callback function will automatically be invoked when the underlying audio system needs data for output. Note that the callback function is called only when the stream is "running" (between calls to the <a class="el" href="class_rt_audio.html#aec017a89629ccef66a90b60be22a2f80" title="A function that starts a stream.">RtAudio::startStream()</a> and <a class="el" href="class_rt_audio.html#af4c241ff86936ecc8108f0d9dfe3efdd" title="Stop a stream, allowing any samples remaining in the output queue to be played.">RtAudio::stopStream()</a> functions). We can also pass a pointer value to the <a class="el" href="class_rt_audio.html#a6907539d2527775df778ebce32ef1e3b" title="A public function for opening a stream with the specified parameters.">RtAudio::openStream()</a> function that is made available in the callback function. In this way, it is possible to gain access to arbitrary data created in our <em>main()</em> function from within the globally defined callback function.</p>
<p>In this example, we stop the stream with an explicit call to <a class="el" href="class_rt_audio.html#af4c241ff86936ecc8108f0d9dfe3efdd" title="Stop a stream, allowing any samples remaining in the output queue to be played.">RtAudio::stopStream()</a>. It is also possible to stop a stream by returning a non-zero value from the callback function. A return value of 1 will cause the stream to finish draining its internal buffers and then halt (equivalent to calling the <a class="el" href="class_rt_audio.html#af4c241ff86936ecc8108f0d9dfe3efdd" title="Stop a stream, allowing any samples remaining in the output queue to be played.">RtAudio::stopStream()</a> function). A return value of 2 will cause the stream to stop immediately (equivalent to calling the <a class="el" href="class_rt_audio.html#ad0586b47cd6bb9591a80b4052815991f" title="Stop a stream, discarding any samples remaining in the input/output queue.">RtAudio::abortStream()</a> function). </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="astruct_rt_audio_1_1_stream_parameters_html"><div class="ttname"><a href="struct_rt_audio_1_1_stream_parameters.html">RtAudio::StreamParameters</a></div><div class="ttdoc">The structure for specifying input or ouput stream parameters.</div><div class="ttdef"><b>Definition:</b> RtAudio.h:318</div></div>
<div class="ttc" id="autypes_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="utypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> utypes.h:188</div></div>
<div class="ttc" id="aclass_rt_audio_html"><div class="ttname"><a href="class_rt_audio.html">RtAudio</a></div><div class="ttdoc">Realtime audio i/o C++ classes.</div><div class="ttdef"><b>Definition:</b> RtAudio.h:279</div></div>
<div class="ttc" id="agroup__gtc__constants_html_ga4b7956eb6e2fbedfc7cf2e46e85c5139"><div class="ttname"><a href="group__gtc__constants.html#ga4b7956eb6e2fbedfc7cf2e46e85c5139">glm::e</a></div><div class="ttdeci">GLM_FUNC_DECL GLM_CONSTEXPR genType e()</div><div class="ttdef"><b>Definition:</b> constants.inl:117</div></div>
<div class="ttc" id="aclass_rt_audio_error_html"><div class="ttname"><a href="class_rt_audio_error.html">RtAudioError</a></div><div class="ttdoc">Exception handling class for RtAudio.</div><div class="ttdef"><b>Definition:</b> RtAudio.h:219</div></div>
<div class="ttc" id="astructbuffer_html"><div class="ttname"><a href="structbuffer.html">buffer</a></div><div class="ttdef"><b>Definition:</b> pngimage.c:372</div></div>
<div class="ttc" id="a_rt_audio_8h_html_a80e306d363583da3b0a1b65d9b57c806"><div class="ttname"><a href="_rt_audio_8h.html#a80e306d363583da3b0a1b65d9b57c806">RtAudioStreamStatus</a></div><div class="ttdeci">unsigned int RtAudioStreamStatus</div><div class="ttdoc">RtAudio stream status (over- or underflow) flags.</div><div class="ttdef"><b>Definition:</b> RtAudio.h:159</div></div>
<div class="ttc" id="a_rt_audio_8h_html"><div class="ttname"><a href="_rt_audio_8h.html">RtAudio.h</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
