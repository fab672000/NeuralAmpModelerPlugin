<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Mega Drone</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Mega Drone </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Ever wondered what 100 square waves sound like when played together? Well now you can find out!</p>
<p>Mega Drone is an app which creates 100 oscillators, combines their output in a mixer and plays the resulting sound.</p>
<p>This sample demonstrates how to obtain the lowest latency and optimal computational throughput by:</p>
<p>1) Leaving Oboe to choose the best default stream properties for the current device 2) Setting performance mode to LowLatency 3) Setting sharing mode to Exclusive 4) Setting the buffer size to 2 bursts 5) Using the <code>-Ofast</code> compiler optimization flag, even when building the <code>Debug</code> variant 6) Using <a href="https://developer.android.com/reference/android/os/Process#getExclusiveCores()"><code>getExclusiveCores</code></a> (API 24+) and thread affinity to bind the audio thread to the best available CPU core(s) 7) Using a <code>StabilizedCallback</code> which aims to spend a fixed percentage of the callback time to avoid CPU frequency scaling (<a href="https://www.youtube.com/watch?v=C0BPXZIvG-Q&amp;feature=youtu.be&amp;t=1158">video explanation</a>)</p>
<p>This code was presented at <a href="http://www.aes.org/events/144/">AES Milan</a> and <a href="https://www.de.droidcon.com/">Droidcon Berlin</a> as part of a talk on Oboe.</p>
<p>The <a href="https://medium.com/@donturner/debugging-audio-glitches-on-android-ed10782f9c64">following article explaining how to debug CPU performance problems</a> may also be useful when looking at this code.</p>
<h1><a class="anchor" id="autotoc_md472"></a>
Implementation details</h1>
<p>The stream properties are left to Oboe as such the app must output audio data in a format which matches that of the stream.</p>
<p>Four different formats are supported:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Channel count </th><th class="markdownTableHeadNone">Format  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1 - Mono </td><td class="markdownTableBodyNone">16-bit int  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2 - Stereo </td><td class="markdownTableBodyNone">16-bit int  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1 - Mono </td><td class="markdownTableBodyNone">Float  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1 - Stereo </td><td class="markdownTableBodyNone">Float  </td></tr>
</table>
<p>The signal chain for mono streams is: </p><pre class="fragment">Oscillators-&gt;Mixer
</pre><p>For stereo chains a mono to stereo converter is added to the end of the chain: </p><pre class="fragment">Oscillators-&gt;Mixer-&gt;MonoToStereo
</pre><p>The compiler optimization flag <code>-Ofast</code> can be found in <a href="CMakeLists.txt">CMakeLists.txt</a>.</p>
<h1><a class="anchor" id="autotoc_md473"></a>
Screenshots</h1>
<p><img src="megadrone-screenshot.png" alt="megadrone-screenshot" class="inline"/> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
